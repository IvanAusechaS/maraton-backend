generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Usuario {
  id                   Int          @id @default(autoincrement())
  email                String       @unique
  password             String
  username             String
  fecha_nacimiento     DateTime
  resetPasswordExpires DateTime?
  resetPasswordToken   String?
  comentarios          Comentario[]
  gustos               Gusto[]
}

model Gusto {
  id            Int      @id @default(autoincrement())
  favoritos     Boolean  @default(false)
  reproducida   Boolean  @default(false)
  ver_mas_tarde Boolean  @default(false)
  calificacion  Int      @default(0)
  usuarioId     Int
  peliculaId    Int
  pelicula      Pelicula @relation(fields: [peliculaId], references: [id])
  usuario       Usuario  @relation(fields: [usuarioId], references: [id])

  @@unique([usuarioId, peliculaId])
}

model Comentario {
  id                Int          @id @default(autoincrement())
  mensaje           String
  usuarioId         Int
  peliculaId        Int
  comentarioPadreId Int?
  comentarioPadre   Comentario?  @relation("Respuestas", fields: [comentarioPadreId], references: [id])
  respuestas        Comentario[] @relation("Respuestas")
  pelicula          Pelicula     @relation(fields: [peliculaId], references: [id])
  usuario           Usuario      @relation(fields: [usuarioId], references: [id])
}

model Pelicula {
  id              Int           @id @default(autoincrement())
  duracion        Int
  largometraje    String        @unique
  actores         String
  a√±o            Int
  disponible      Boolean
  sinopsis        String
  trailer         String
  titulo          String
  director        String
  portada         String
  idiomaId        Int
  catalogos       Catalogo[]
  comentarios     Comentario[]
  gustos          Gusto[]
  idioma          Idioma        @relation(fields: [idiomaId], references: [id])
  subtitulos      Subtitulo[]
}

model Genero {
  id          Int        @id @default(autoincrement())
  nombre      String     @unique @map("descripcion")
  estado      Boolean
  catalogos   Catalogo[]
}

model Catalogo {
  id         Int      @id @default(autoincrement())
  peliculaId Int
  generoId   Int
  genero     Genero   @relation(fields: [generoId], references: [id])
  pelicula   Pelicula @relation(fields: [peliculaId], references: [id])
}

model Idioma {
  id         Int         @id @default(autoincrement())
  nombre     String
  version    String
  peliculas  Pelicula[]
  subtitulos Subtitulo[]
}

model Subtitulo {
  id          Int      @id @default(autoincrement())
  estado      Boolean
  color       String
  fuente      String
  descriptiva Boolean
  peliculaId  Int
  idiomaId    Int
  idioma      Idioma   @relation(fields: [idiomaId], references: [id])
  pelicula    Pelicula @relation(fields: [peliculaId], references: [id])
}
